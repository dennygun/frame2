<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Minimalist Camera, Hand Draw, 80th Anniversary Indonesia Independence</title>
  <style>
    html, body { height: 100%; margin: 0; background: #000; display: flex; justify-content: center; align-items: center; }
    .cam-wrap { position: relative; width: 100%; max-width: 800px; aspect-ratio: 3/4; }
    video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); }
    canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
    .frame { pointer-events: none; position: absolute; inset: 0; box-shadow: 0 0 0 10px white inset, 0 0 0 20px red inset; }
    .ribbon { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); background: white; color: red; padding: 5px 10px; border-radius: 999px; font-weight: bold; font-size: 14px; }
  </style>
</head>
<body>
  <div class="cam-wrap">
    <video id="video" autoplay playsinline></video>
    <canvas id="overlay"></canvas>
    <canvas id="draw"></canvas>
    <div class="frame"></div>
    <div class="ribbon">80th Anniversary Indonesia Independence</div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
  <script>
    const video = document.getElementById('video');
    const overlay = document.getElementById('overlay');
    const drawCanvas = document.getElementById('draw');
    const octx = overlay.getContext('2d');
    const dctx = drawCanvas.getContext('2d');
    let drawing = false, lastPt = null;

    function resizeCanvas() {
      overlay.width = overlay.clientWidth;
      overlay.height = overlay.clientHeight;
      drawCanvas.width = overlay.clientWidth;
      drawCanvas.height = overlay.clientHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function pinchDistance(landmarks) {
      const a = landmarks[4];
      const b = landmarks[8];
      const dx = a.x - b.x;
      const dy = a.y - b.y;
      return Math.hypot(dx, dy);
    }

    function onResults(results) {
      octx.clearRect(0, 0, overlay.width, overlay.height);
      if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
        const landmarks = results.multiHandLandmarks[0];
        const dist = pinchDistance(landmarks);
        const x = (1 - landmarks[8].x) * overlay.width;
        const y = landmarks[8].y * overlay.height;

        if (dist < 0.05) {
          if (!drawing) {
            drawing = true;
            lastPt = { x, y };
          } else {
            dctx.beginPath();
            dctx.moveTo(lastPt.x, lastPt.y);
            dctx.lineTo(x, y);
            dctx.strokeStyle = 'white';
            dctx.lineWidth = 4;
            dctx.stroke();
            lastPt = { x, y };
          }
        } else {
          drawing = false;
          lastPt = null;
        }
      }
    }

    const hands = new Hands({ locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}` });
    hands.setOptions({ maxNumHands: 1, modelComplexity: 1, minDetectionConfidence: 0.5, minTrackingConfidence: 0.5 });
    hands.onResults(onResults);

    const camera = new Camera(video, {
      onFrame: async () => {
        await hands.send({ image: video });
      },
      width: 640,
      height: 480
    });
    camera.start();
  </script>
</body>
</html>
