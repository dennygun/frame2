<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>80th Indonesia Independence - Camera</title>
<style>
  body, html {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: black;
  }
  canvas {
    position: absolute;
    top: 0;
    left: 0;
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
</head>
<body>
<video id="video" playsinline style="display:none;"></video>
<canvas id="canvas"></canvas>

<script>
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let drawing = false;
let prevX = null, prevY = null;

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

const hands = new Hands({
  locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
});
hands.setOptions({
  maxNumHands: 1,
  modelComplexity: 1,
  minDetectionConfidence: 0.7,
  minTrackingConfidence: 0.7
});

hands.onResults(results => {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  // Draw video first
  ctx.drawImage(results.image, 0, 0, canvas.width, canvas.height);
  
  // Red-white frame
  ctx.lineWidth = 40;
  ctx.strokeStyle = "red";
  ctx.strokeRect(0, 0, canvas.width, canvas.height);
  ctx.strokeStyle = "white";
  ctx.strokeRect(20, 20, canvas.width - 40, canvas.height - 40);
  
  ctx.fillStyle = "white";
  ctx.font = "bold 36px sans-serif";
  ctx.textAlign = "center";
  ctx.fillText("80th Anniversary Indonesia Independence", canvas.width / 2, 50);

  if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
    const hand = results.multiHandLandmarks[0];
    const indexTip = hand[8];
    const thumbTip = hand[4];

    const ix = indexTip.x * canvas.width;
    const iy = indexTip.y * canvas.height;
    const tx = thumbTip.x * canvas.width;
    const ty = thumbTip.y * canvas.height;

    const dist = Math.hypot(ix - tx, iy - ty);

    if (dist < 40) { // Pinch threshold
      if (!drawing) {
        drawing = true;
        prevX = ix;
        prevY = iy;
      } else {
        ctx.beginPath();
        ctx.strokeStyle = "yellow";
        ctx.lineWidth = 5;
        ctx.moveTo(prevX, prevY);
        ctx.lineTo(ix, iy);
        ctx.stroke();
        prevX = ix;
        prevY = iy;
      }
    } else {
      drawing = false;
      prevX = null;
      prevY = null;
    }
  }
});

async function initCamera() {
  const stream = await navigator.mediaDevices.getUserMedia({ video: true });
  video.srcObject = stream;
  await video.play();

  const camera = new Camera(video, {
    onFrame: async () => {
      await hands.send({ image: video });
    },
    width: 1280,
    height: 720
  });
  camera.start();
}

initCamera();
</script>
</body>
</html>
